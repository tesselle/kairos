---
output: github_document
bibliography: vignettes/bibliography.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = NULL
)
```

# kairos <img width=120px src="man/figures/logo.png" align="right" />

<!-- badges: start -->
[![R-CMD-check](https://github.com/tesselle/kairos/workflows/R-CMD-check/badge.svg)](https://github.com/tesselle/kairos/actions)
[![codecov](https://codecov.io/gh/tesselle/kairos/branch/master/graph/badge.svg)](https://app.codecov.io/gh/tesselle/kairos)
[![CodeFactor](https://www.codefactor.io/repository/github/tesselle/kairos/badge)](https://www.codefactor.io/repository/github/tesselle/kairos)

[![r-universe](https://tesselle.r-universe.dev/badges/kairos)](https://tesselle.r-universe.dev){.pkgdown-devel}
[![CRAN Version](http://www.r-pkg.org/badges/version/kairos)](https://cran.r-project.org/package=kairos){.pkgdown-release}
[![CRAN checks](https://cranchecks.info/badges/worst/kairos)](https://cran.r-project.org/web/checks/check_results_kairos.html){.pkgdown-release}
[![CRAN Downloads](http://cranlogs.r-pkg.org/badges/kairos)](https://cran.r-project.org/package=kairos){.pkgdown-release}

[![Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.5653896.svg)](https://doi.org/10.5281/zenodo.5653896)
<!-- badges: end -->

## Overview
A convenient and reproducible toolkit for relative and absolute dating and analysis of chronological patterns. This package includes functions for chronological modeling and dating of archaeological assemblages from count data. It provides methods for matrix seriation. It also allows to compute time point estimates and density estimates of the occupation and duration of an archaeological site. **kairos** provides methods for:

* Matrix seriation: `seriate_rank()` and `seriate_average()`
* Mean ceramic date estimation [@south1977]: `mcd()`
* Event and accumulation date estimation [@bellanger2012]: `event()`
* Aoristic analysis [@ratcliffe2000]: `aoristic()`
* Chronological apportioning [@roberts2012]: `apportion()`

## Installation

You can install the released version of **kairos** from [CRAN](https://CRAN.R-project.org) with:

```{r cran-installation, eval=FALSE}
install.packages("kairos")
```

And the development version from [GitHub](https://github.com/) with:

```{r gh-installation, eval=FALSE}
# install.packages("remotes")
remotes::install_github("tesselle/kairos")
```

## Usage

```{r packages-load}
## Load packages
library(kairos)
library(folio) # datasets
```

**kairos** only supports dates expressed in CE years (BCE years must be given as negative numbers). **All results are rounded to zero decimal places** (sub-annual precision does not make sense in most situations). You can change this behavior with `options(kairos.precision = x)` (for `x` decimal places).

*It assumes that you keep your data tidy*: each variable (type/taxa) must be saved in its own column and each observation (sample/case) must be saved in its own row.

```{r seriation, fig.width=3.5, fig.height=3.5, out.width='50%', fig.show='hold'}
## Build an incidence matrix with random data
set.seed(12345)
incidence1 <- matrix(sample(0:1, 400, TRUE, c(0.6, 0.4)), nrow = 20)

## Get seriation order on rows and columns
## If no convergence is reached before the maximum number of iterations (100), 
## it stops with a warning.
(indices <- seriate_rank(incidence1, margin = c(1, 2), stop = 100))

## Permute rows and columns
incidence2 <- permute(incidence1, indices)

## Plot matrix
heatmap(incidence1, Rowv = NA, Colv = NA, revC = TRUE, 
        scale = "none", col = c("white", "black"))
heatmap(incidence2, Rowv = NA, Colv = NA, revC = TRUE, 
        scale = "none", col = c("white", "black"))
```

## Contributing

Please note that the **kairos** project is released with a [Contributor Code of Conduct](https://www.tesselle.org/conduct.html). By contributing to this project, you agree to abide by its terms.

## References
